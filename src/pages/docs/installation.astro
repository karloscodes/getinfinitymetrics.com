---
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";

const pageTitle = "Installation | Infinity Metrics";
const pageDescription =
  "Complete installation guide for Infinity Metrics - automated installer and Docker deployment options.";

// Code examples
const installCommand =
  "curl -fsSL https://getinfinitymetrics.com/install -o install.sh && sudo bash install.sh";
const dockerRunCommand = `docker run -d \\
  --name infinity-metrics \\
  -v /path/to/storage:/app/storage \\
  -v /path/to/logs:/app/logs \\
  -e INFINITY_METRICS_LOG_LEVEL=debug \\
  -e INFINITY_METRICS_APP_PORT=8080 \\
  -e INFINITY_METRICS_LICENSE_KEY=your-license-key \\
  -e INFINITY_METRICS_DOMAIN=your-domain.com \\
  -e INFINITY_METRICS_PRIVATE_KEY=your-private-key \\
  --restart unless-stopped \\
  infinitymetrics/app:latest`;
---

<Layout title={pageTitle} description={pageDescription}>
  <Header />
  <main class="py-12 md:py-20 overflow-hidden">
    <div class="container px-4 sm:px-6 overflow-hidden">
      <div class="max-w-4xl mx-auto">
        <!-- Breadcrumb -->
        <nav class="mb-8">
          <ol class="flex space-x-2 text-sm text-gray-500">
            <li>
              <a href="/docs" class="hover:text-gray-700">Documentation</a>
            </li>
            <li>/</li>
            <li class="text-gray-900">Installation</li>
          </ol>
        </nav>

        <h1
          class="text-4xl md:text-5xl font-bold mb-6 text-black"
        >
          Installation Guide
        </h1>

        <p class="text-xl text-gray-600 mb-8">
          Choose the installation method that best fits your needs. We offer
          both automated and manual installation options.
        </p>

        <!-- Installation Methods -->
        <section class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-black">
            Installation Methods
          </h2>
          <div class="grid md:grid-cols-2 gap-6 mb-8">
            <div
              class="card p-6 rounded-xl shadow-sm border border-gray-200"
            >
              <h3 class="text-xl font-black mb-3 text-black">
                Automated Installation
              </h3>
              <p class="text-gray-600 mb-4">
                One-command installation with automatic SSL setup. Perfect for
                Ubuntu Server users.
              </p>
              <ul class="text-sm text-gray-600 space-y-1 mb-4">
                <li>✅ Automatic SSL certificates</li>
                <li>✅ Caddy proxy configuration</li>
                <li>✅ System service setup</li>
                <li>✅ Automatic updates</li>
              </ul>
              <a
                href="#automated"
                class="text-blue hover:text-blue-600 font-medium"
              >
                Get Started →
              </a>
            </div>
            <div
              class="card p-6 rounded-xl shadow-sm border border-gray-200"
            >
              <h3 class="text-xl font-black mb-3 text-black">
                Docker Installation
              </h3>
              <p class="text-gray-600 mb-4">
                Self-managed Docker deployment for advanced users and non-Ubuntu
                systems.
              </p>
              <ul class="text-sm text-gray-600 space-y-1 mb-4">
                <li>✅ Works on any Linux distribution</li>
                <li>✅ Full control over configuration</li>
                <li>✅ Easy to integrate with existing infrastructure</li>
                <li>✅ Manual update control</li>
              </ul>
              <a
                href="#docker"
                class="text-blue hover:text-blue-600 font-medium"
              >
                Get Started →
              </a>
            </div>
          </div>
        </section>

        <!-- Prerequisites -->
        <section class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-black">Prerequisites</h2>
          <div
            class="bg-gray-50 border-l-4 border-gray-400 p-6 rounded-r-xl mb-6"
          >
            <h3 class="text-lg font-semibold mb-2 text-gray-700">
              Before You Begin
            </h3>
            <ul class="text-gray-700 space-y-1">
              <li>
                • A valid Infinity Metrics license (purchase from our <a
                  href="/#pricing"
                  class="underline">pricing page</a
                >)
              </li>
              <li>• A server or VPS running Linux</li>
              <li>• Root or sudo access to the server</li>
              <li>• Domain name pointed to your server</li>
              <li>• Open ports 80 and 443 for SSL certificate setup</li>
            </ul>
          </div>
        </section>

        <!-- Automated Installation -->
        <section id="automated" class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-black">
            Automated Installation
          </h2>
          <p class="text-gray-600 mb-6">
            The automated installer handles everything for you, including SSL
            certificates and proxy configuration.
          </p>

          <div class="space-y-6">
            <div class="bg-gray-50 border-l-4 border-gray-400 p-6 rounded-r-xl">
              <h3 class="text-lg font-semibold mb-2 text-gray-800">
                System Requirements
              </h3>
              <ul class="text-gray-700 space-y-1">
                <li>• Ubuntu Server 20.04 LTS or newer</li>
                <li>• 512MB RAM minimum (1GB recommended)</li>
                <li>• 10GB free disk space</li>
                <li>• Internet connection for package installation</li>
              </ul>
            </div>

            <div>
              <h3 class="text-xl font-semibold mb-4 text-black">
                Installation Steps
              </h3>

              <div class="space-y-4">
                <div class="flex items-start">
                  <div
                    class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm mr-3"
                  >
                    1
                  </div>
                  <div>
                    <h4 class="font-semibold text-black mb-2">
                      Run the installer
                    </h4>
                    <p class="text-gray-600 mb-3">
                      Execute the following command on your server:
                    </p>
                    <div
                      class="bg-black p-4 rounded-md font-mono text-sm overflow-x-auto"
                    >
                      <pre
                        class="text-white"><code>{installCommand}</code></pre>
                    </div>
                  </div>
                </div>

                <div class="flex items-start">
                  <div
                    class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold text-sm mr-3"
                  >
                    2
                  </div>
                  <div>
                    <h4 class="font-semibold text-black mb-2">
                      Follow the prompts
                    </h4>
                    <p class="text-gray-600 mb-3">
                      The installer will ask for:
                    </p>
                    <ul class="text-gray-600 space-y-1">
                      <li>• Your license key</li>
                      <li>• Domain name for your installation</li>
                      <li>• Email address for SSL certificate</li>
                      <li>• Admin password for the dashboard</li>
                    </ul>
                  </div>
                </div>

                <div class="flex items-start">
                  <div
                    class="flex-shrink-0 w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-sm mr-3"
                  >
                    3
                  </div>
                  <div>
                    <h4 class="font-semibold text-black mb-2">
                      Access your dashboard
                    </h4>
                    <p class="text-gray-600">
                      Once installation is complete, visit <code
                        class="bg-gray-100 px-2 py-1 rounded"
                        >https://your-domain.com</code
                      > to access your Infinity Metrics dashboard.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-gray-50 border-l-4 border-gray-400 p-6 rounded-r-xl">
              <h3 class="text-lg font-semibold mb-2 text-gray-700">
                What the installer does:
              </h3>
              <ul class="text-gray-700 space-y-1">
                <li>• Downloads and installs Infinity Metrics</li>
                <li>• Sets up Caddy as a reverse proxy</li>
                <li>
                  • Configures automatic SSL certificates with Let's Encrypt
                </li>
                <li>• Creates system services for automatic startup</li>
                <li>• Sets up automatic updates</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- Docker Installation -->
        <section id="docker" class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-black">
            Docker Installation
          </h2>
          <p class="text-gray-600 mb-6">
            For advanced users or those running non-Ubuntu systems, you can
            deploy Infinity Metrics using Docker.
          </p>

          <div class="space-y-6">
            <div class="bg-gray-50 border-l-4 border-gray-400 p-6 rounded-r-xl">
              <h3 class="text-lg font-semibold mb-2 text-gray-800">
                System Requirements
              </h3>
              <ul class="text-gray-700 space-y-1">
                <li>• Any Linux distribution with Docker support</li>
                <li>• Docker Engine 20.10+ installed</li>
                <li>• 512MB RAM minimum (1GB recommended)</li>
                <li>• 10GB free disk space</li>
              </ul>
            </div>

            <div>
              <h3 class="text-xl font-semibold mb-4 text-black">
                Required Environment Variables
              </h3>
              <div class="overflow-x-auto">
                <table
                  class="min-w-full divide-y divide-gray-200 border border-gray-200 rounded-lg"
                >
                  <thead class="bg-gray-50">
                    <tr>
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >Variable</th
                      >
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >Description</th
                      >
                      <th
                        class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                        >Example</th
                      >
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
                        >INFINITY_METRICS_LICENSE_KEY</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500"
                        >Your license key from purchase</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500">abc123...</td>
                    </tr>
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
                        >INFINITY_METRICS_DOMAIN</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500"
                        >Your domain name</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500"
                        >analytics.example.com</td
                      >
                    </tr>
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
                        >INFINITY_METRICS_PRIVATE_KEY</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500"
                        >32-character random string</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500"
                        >abcd1234...</td
                      >
                    </tr>
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
                        >INFINITY_METRICS_APP_PORT</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500"
                        >Port for the application</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500">8080</td>
                    </tr>
                    <tr>
                      <td
                        class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"
                        >INFINITY_METRICS_LOG_LEVEL</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500"
                        >Logging level</td
                      >
                      <td class="px-6 py-4 text-sm text-gray-500">info</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <div>
              <h3 class="text-xl font-semibold mb-4 text-black">
                Docker Command
              </h3>
              <p class="text-gray-600 mb-3">
                Replace the placeholder values with your actual configuration:
              </p>
              <div
                class="bg-black p-4 rounded-md font-mono text-sm overflow-x-auto"
              >
                <pre class="text-white"><code>{dockerRunCommand}</code></pre>
              </div>
            </div>

            <div class="bg-gray-50 border-l-4 border-gray-400 p-6 rounded-r-xl">
              <h3 class="text-lg font-semibold mb-2 text-gray-700">
                Important Notes:
              </h3>
              <ul class="text-gray-700 space-y-1">
                <li>
                  • You'll need to set up your own reverse proxy (Nginx, Caddy,
                  etc.)
                </li>
                <li>• SSL certificates must be configured separately</li>
                <li>• Updates are manual - you control when to update</li>
                <li>• Make sure to persist data by mounting volumes</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- Post-Installation -->
        <section class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-black">Post-Installation</h2>
          <div class="space-y-6">
            <div class="card p-6 rounded-xl shadow-sm">
              <h3 class="text-xl font-semibold mb-3 text-black">
                1. Verify Installation
              </h3>
              <p class="text-gray-600 mb-4">
                Check that Infinity Metrics is running correctly:
              </p>
              <ul class="text-gray-600 space-y-1">
                <li>• Visit your domain in a web browser</li>
                <li>• You should see the Infinity Metrics login page</li>
                <li>
                  • Check that SSL certificate is working (green lock icon)
                </li>
                <li>• Log in with your admin credentials</li>
              </ul>
            </div>

            <div class="card p-6 rounded-xl shadow-sm">
              <h3 class="text-xl font-semibold mb-3 text-black">
                2. Add Tracking Script
              </h3>
              <p class="text-gray-600 mb-4">
                Add the tracking script to your website:
              </p>
              <div
                class="bg-black p-4 rounded-md font-mono text-sm overflow-x-auto"
              >
                <pre
                  class="text-white"><code>&lt;script defer src="https://your-domain.com/api/v1/sdk.js"&gt;&lt;/script&gt;</code></pre>
              </div>
              <p class="text-gray-600 mt-3">
                See our <a
                  href="/docs/frameworks"
                  class="text-gray-700 hover:underline">framework guides</a
                > for specific integration instructions.
              </p>
            </div>

            <div class="card p-6 rounded-xl shadow-sm">
              <h3 class="text-xl font-semibold mb-3 text-black">
                3. Test Data Collection
              </h3>
              <p class="text-gray-600 mb-4">
                Verify that analytics data is being collected:
              </p>
              <ul class="text-gray-600 space-y-1">
                <li>• Visit your website with the tracking script installed</li>
                <li>• Check your Infinity Metrics dashboard</li>
                <li>• You should see page views appear within a few minutes</li>
                <li>• Use browser developer tools to verify script loads</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- Troubleshooting -->
        <section class="mb-12">
          <h2 class="text-3xl font-bold mb-6 text-black">Troubleshooting</h2>
          <div class="space-y-4">
            <details class="bg-gray-50 rounded-lg p-4">
              <summary class="cursor-pointer font-medium text-black"
                >Installation fails with permission errors</summary
              >
              <div class="mt-3 text-gray-600">
                <p>
                  Make sure you're running the installer with sudo privileges:
                </p>
                <code class="bg-gray-200 px-2 py-1 rounded"
                  >sudo bash install.sh</code
                >
              </div>
            </details>

            <details class="bg-gray-50 rounded-lg p-4">
              <summary class="cursor-pointer font-medium text-black"
                >SSL certificate issues</summary
              >
              <div class="mt-3 text-gray-600">
                <p>
                  Ensure your domain is pointed to your server and ports 80/443
                  are open. Let's Encrypt needs to verify domain ownership.
                </p>
              </div>
            </details>

            <details class="bg-gray-50 rounded-lg p-4">
              <summary class="cursor-pointer font-medium text-black"
                >Docker container won't start</summary
              >
              <div class="mt-3 text-gray-600">
                <p>
                  Check that all required environment variables are set and your
                  license key is valid. Use <code
                    class="bg-gray-200 px-2 py-1 rounded"
                    >docker logs infinity-metrics</code
                  > to see error messages.
                </p>
              </div>
            </details>

            <details class="bg-gray-50 rounded-lg p-4">
              <summary class="cursor-pointer font-medium text-black"
                >Can't access dashboard</summary
              >
              <div class="mt-3 text-gray-600">
                <p>
                  Make sure your domain DNS is properly configured and the
                  server is running. Check firewall settings for ports 80 and
                  443.
                </p>
              </div>
            </details>
          </div>
        </section>

        <!-- Next Steps -->
        <section class="bg-gray-50 rounded-xl p-8">
          <h2 class="text-2xl font-bold mb-4 text-black">Next Steps</h2>
          <p class="text-gray-600 mb-6">
            Great! You've successfully installed Infinity Metrics. Here's what
            to do next:
          </p>
          <div class="grid md:grid-cols-2 gap-4">
            <a
              href="/docs/getting-started"
              class="bg-white p-4 rounded-lg border border-blue-200 hover:border-blue-300 transition-colors"
            >
              <h3 class="font-black text-black mb-2">Getting Started Guide</h3>
              <p class="text-gray-600 text-sm">
                Learn the basics and add your first tracking script
              </p>
            </a>
            <a
              href="/docs/frameworks"
              class="bg-white p-4 rounded-lg border border-blue-200 hover:border-blue-300 transition-colors"
            >
              <h3 class="font-black text-black mb-2">Framework Integration</h3>
              <p class="text-gray-600 text-sm">
                Framework-specific installation guides
              </p>
            </a>
            <a
              href="/docs/configuration"
              class="bg-white p-4 rounded-lg border border-blue-200 hover:border-blue-300 transition-colors"
            >
              <h3 class="font-black text-black mb-2">Configuration</h3>
              <p class="text-gray-600 text-sm">
                Customize your Infinity Metrics setup
              </p>
            </a>
            <a
              href="/docs/admin"
              class="bg-white p-4 rounded-lg border border-blue-200 hover:border-blue-300 transition-colors"
            >
              <h3 class="font-semibold text-black mb-2">🔧 Admin Operations</h3>
              <p class="text-gray-600 text-sm">
                Manage your installation and perform updates
              </p>
            </a>
          </div>
        </section>
      </div>
    </div>
  </main>
  <Footer />
</Layout>
