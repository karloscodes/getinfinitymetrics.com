---
const faqs = [
  {
    question: "What's self-hosting like?",
    answer:
      "You own your data, fully. It's lightweight, runs on Docker with just 512MB RAM on any VPS. Plus, it supports multiple websites out of the box.",
  },
  {
    question: "How easy is the setup?",
    answer:
      "One command, done. Installs in seconds via Docker, no fuss. Updates? They're automated, zero-downtime, and always backward-compatible.",
  },
  {
    question: "Can I manage my data?",
    answer:
      "Totally. It's yours in a SQLite database, query it, export it, or plug it into your tools anytime.",
  },
  {
    question: "What's the deal with AI support?",
    answer:
      "Ask AI anything about your analytics, anytime. It's built in, ready to help you dig deeper into your data.",
  },
  {
    question: "How does pricing work?",
    answer:
      "One-time payment, lifetime access, no subscriptions. Not happy? We've got a 30-day money-back guarantee.",
  },
  {
    question: "Do updates cost extra?",
    answer:
      "Updates within the same major version (1.0 to 1.1) are free. Regarding major version upgrades (1.x to 2.x), I'm still determining the pricing structure. Since this is a new product, I want to be honest that I haven't finalized how future major version upgrades will be handled yet. You'll always have the choice whether to upgrade to a new major version when the time comes.",
  },
  {
    question: "How does privacy-first tracking work?",
    answer:
      "Infinity Metrics ditches cookies for fingerprinting and session-based analytics, no personal data stored. You get accurate insights while keeping user privacy intact.",
  },
  {
    question: "Is it really GDPR compliant?",
    answer:
      "Yes —100%. No cookies, no personal data, no consent banners needed. Just anonymous stats, privacy-first by design.",
  },
];
---

<section id="faq" class="py-24 md:py-32 hero-gradient">
  <div class="container">
    <div class="max-w-3xl mx-auto mb-16 text-center">
      <span class="inline-block px-3 py-1 bg-black bg-opacity-5 rounded-full text-sm font-medium mb-4">
        FAQ
      </span>
      <h2 class="text-4xl md:text-5xl font-bold mb-6 bg-clip-text text-transparent bg-gradient-to-r from-black to-gray-700">
        Frequently Asked Questions
      </h2>
      <p class="text-gray-600 text-lg">
        Everything you need to know about Infinity Metrics
      </p>
    </div>

    <div class="max-w-3xl mx-auto">
      <div class="space-y-5" id="faq-container">
        {
          faqs.map((faq, index) => (
            <div class="faq-item bg-white rounded-xl shadow-md hover:shadow-lg transition-all duration-300">
              <h3>
                <button 
                  class="w-full flex justify-between items-center text-left font-medium text-gray-800 p-6 hover:text-black transition-colors duration-200" 
                  aria-expanded="false"
                  aria-controls={`faq-content-${index}`}
                  data-faq-toggle
                >
                  <span class="text-lg font-bold">{faq.question}</span>
                  <span class="flex items-center justify-center w-8 h-8 rounded-full bg-black bg-opacity-5 transition-all duration-300 hover:bg-opacity-10">
                    <svg
                      class="faq-icon h-5 w-5 transition-transform duration-300"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                      aria-hidden="true"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                      />
                    </svg>
                  </span>
                </button>
              </h3>

              <div id={`faq-content-${index}`} class="faq-content px-6 pb-6 pt-0 text-gray-600">
                <div class="h-px bg-gray-200 mb-4"></div>
                <p class="leading-relaxed">{faq.answer}</p>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What's self-hosting like?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "You own your data, fully. It's lightweight, runs on Docker with just 512MB RAM on any VPS. Plus, it supports multiple websites out of the box."
        }
      },
      {
        "@type": "Question",
        "name": "How easy is the setup?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "One command, done. Installs in seconds via Docker, no fuss. Updates? They're automated, zero-downtime, and always backward-compatible."
        }
      },
      {
        "@type": "Question",
        "name": "Can I manage my data?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Totally. It's yours in a SQLite database, query it, export it, or plug it into your tools anytime."
        }
      },
      {
        "@type": "Question",
        "name": "What's the deal with AI support?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Ask AI anything about your analytics, anytime. It's built in, ready to help you dig deeper into your data."
        }
      },
      {
        "@type": "Question",
        "name": "How does pricing work?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "One-time payment, lifetime access, no subscriptions. Not happy? We've got a 30-day money-back guarantee."
        }
      },
      {
        "@type": "Question",
        "name": "Do updates cost extra?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Updates within the same major version (1.0 to 1.1) are free. Regarding major version upgrades (1.x to 2.x), I'm still determining the pricing structure. Since this is a new product, I want to be honest that I haven't finalized how future major version upgrades will be handled yet. You'll always have the choice whether to upgrade to a new major version when the time comes."
        }
      },
      {
        "@type": "Question",
        "name": "How does privacy-first tracking work?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Infinity Metrics ditches cookies for fingerprinting and session-based analytics, no personal data stored. You get accurate insights while keeping user privacy intact."
        }
      },
      {
        "@type": "Question",
        "name": "Is it really GDPR compliant?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes —100%. No cookies, no personal data, no consent banners needed. Just anonymous stats, privacy-first by design."
        }
      }
    ]
  }
</script>

<style>
  .faq-content {
    max-height: 0;
    /* opacity: 0; */ /* Removed opacity for simplicity */
    overflow: hidden;
    transition: max-height 0.4s ease-out, padding-bottom 0.4s ease-out;
    padding-top: 0;
    padding-bottom: 0;
  }

  .faq-content.open {
    max-height: 500px; /* Adjust as needed */
    /* opacity: 1; */ /* Removed opacity for simplicity */
    padding-top: 0;
    padding-bottom: 1.5rem; /* pb-6 */
  }

  .faq-item {
    /* @apply opacity-0 transform translate-y-4; */ /* Entry animation still disabled */
    /* animation: fadeInUp 0.5s ease-out forwards; */
    /* animation-delay: calc(var(--animation-order, 0) * 100ms); */
    @apply bg-white rounded-xl shadow-md transition-all duration-300; /* Keep base styles */
  }
  
  @keyframes fadeInUp {
    to {
      @apply opacity-100 translate-y-0;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Set animation delays (keeping this, but animation is commented out in CSS)
    document.querySelectorAll('.faq-item').forEach((item, index) => {
      item.style.setProperty('--animation-order', index);
    });

    // Event Delegation for Accordion toggle
    const faqContainer = document.getElementById('faq-container');
    if (faqContainer) {
      // console.log('FAQ container found, attaching listener.'); // Log 1 - REMOVED
      faqContainer.addEventListener('click', (event) => {
        // console.log('Click detected inside FAQ container.'); // Log 2 - REMOVED
        // Find the button that was clicked (or check if the click was inside a button)
        const button = event.target.closest('[data-faq-toggle]');
        
        if (!button) {
          // console.log('Click was not on a toggle button.'); // Log 3 - REMOVED
          return; 
        }
        // console.log('Toggle button clicked:', button); // Log 4 - REMOVED

        const contentId = button.getAttribute('aria-controls');
        // console.log('Target content ID:', contentId); // Log 5 - REMOVED
        if (!contentId) return;
        const content = document.getElementById(contentId);
        // console.log('Target content element:', content); // Log 6 - REMOVED
        if (!content) return;
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        const currentIcon = button.querySelector('.faq-icon');

        // console.log(`Toggling item ${contentId}. Currently expanded: ${isExpanded}`); // Log 7 - REMOVED
        // Toggle current FAQ
        button.setAttribute('aria-expanded', String(!isExpanded));
        if (currentIcon) {
          currentIcon.classList.toggle('rotate-45');
        }
        content.classList.remove('hidden'); // Explicitly remove hidden
        content.classList.toggle('open');
        // console.log(`Item ${contentId} toggled. New expanded state: ${!isExpanded}. Hidden class removed.`); // Log 8 updated - REMOVED
      });
    } else {
      console.error('FAQ container #faq-container not found!'); // Log Error - REMOVED
    }
  });
</script>
