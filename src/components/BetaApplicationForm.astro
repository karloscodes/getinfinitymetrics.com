// File: src/components/BetaForm.astro

<section id="beta-form" class="py-16 md:py-24 bg-white">
  <div class="container">
    <div class="max-w-2xl mx-auto">
      <div class="card">
        <h2 class="text-2xl font-bold mb-6">Apply for Beta Access</h2>
        <p class="text-gray-600 mb-6">
          Complete this form to join our exclusive beta program. We'll review
          your application and send you access details within 48 hours.
        </p>

        <form
          method="POST"
          data-netlify="true"
          name="beta-signup"
          class="space-y-6"
        >
          <!-- Required hidden input for Netlify Forms -->
          <input type="hidden" name="form-name" value="beta-signup" />

          <div>
            <label for="name" class="block text-sm font-medium mb-1">Name</label
            >
            <input
              type="text"
              id="name"
              name="name"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent"
              required
            />
          </div>

          <div>
            <label for="email" class="block text-sm font-medium mb-1"
              >Email Address</label
            >
            <input
              type="email"
              id="email"
              name="email"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent"
              required
            />
          </div>

          <div>
            <label for="website" class="block text-sm font-medium mb-1"
              >Website URL</label
            >
            <input
              type="url"
              id="website"
              name="website"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent"
              required
            />
          </div>

          <div>
            <label for="company" class="block text-sm font-medium mb-1"
              >Company/Organization</label
            >
            <input
              type="text"
              id="company"
              name="company"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent"
            />
          </div>

          <div>
            <label for="usecase" class="block text-sm font-medium mb-1"
              >How do you plan to use Fusion Analytics?</label
            >
            <textarea
              id="usecase"
              name="usecase"
              rows="3"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent"
              required></textarea>
          </div>

          <div>
            <label for="source" class="block text-sm font-medium mb-1"
              >How did you hear about us?</label
            >
            <select
              id="source"
              name="source"
              class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent"
            >
              <option value="">Please select...</option>
              <option value="search">Search Engine</option>
              <option value="twitter">Twitter</option>
              <option value="github">GitHub</option>
              <option value="friend">Friend/Colleague</option>
              <option value="blog">Blog or Article</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div class="flex items-start">
            <div class="flex items-center h-5">
              <input
                id="feedback"
                name="feedback"
                type="checkbox"
                class="h-4 w-4 border-gray-300 rounded text-black focus:ring-black"
                required
              />
            </div>
            <div class="ml-3 text-sm">
              <label for="feedback" class="text-gray-600"
                >I agree to provide feedback during the beta testing period</label
              >
            </div>
          </div>

          <div class="flex items-start">
            <div class="flex items-center h-5">
              <input
                id="newsletter"
                name="newsletter"
                type="checkbox"
                class="h-4 w-4 border-gray-300 rounded text-black focus:ring-black"
              />
            </div>
            <div class="ml-3 text-sm">
              <label for="newsletter" class="text-gray-600"
                >Keep me updated about Fusion Analytics news and updates
                (optional)</label
              >
            </div>
          </div>

          <div>
            <button type="submit" class="btn-primary w-full"
              >Apply for Beta Access</button
            >
          </div>
        </form>

        <div
          id="success-message"
          class="hidden mt-6 p-4 bg-green-50 border border-green-300 rounded-md"
        >
          <p class="text-green-800 font-medium">
            Thanks for applying to our beta program! We'll review your
            application and get back to you within 48 hours.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Handle form submission and success message
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.querySelector('form[name="beta-signup"]');
    const successMessage = document.getElementById("success-message");

    if (form && successMessage) {
      // Check if we need to show success message (after redirect)
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get("success") === "true") {
        form.classList.add("hidden");
        successMessage.classList.remove("hidden");
      }

      // Netlify forms handle submission automatically, but we can attach an event
      // for custom behavior like analytics tracking
      form.addEventListener("submit", (event) => {
        // Optional: Add analytics tracking code here
        // Example: gtag('event', 'beta_signup_submit', { 'event_category': 'forms' });
      });
    }
  });
</script>
